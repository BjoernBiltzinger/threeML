sudo: required

language: python
#<<<<<<< HEAD
#python:
#  # We don't actually use the Travis Python, but this keeps it organized.
#  - "2.7"
#
#before_install:
#    - pip install pytest pytest-cov
#    - pip install coveralls
#
#install:
#  - sudo apt-get update
#  # We do this conditionally because it saves us some downloading if the
#  # version is the same.
#  - if [[ "$TRAVIS_PYTHON_VERSION" == "2.7" ]]; then
#      wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh -O miniconda.sh;
#    else
#      wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
#    fi
#  - bash miniconda.sh -b -p $HOME/miniconda
#  - export PATH="$HOME/miniconda/bin:$PATH"
#  - hash -r
#  - conda config --set always_yes yes --set changeps1 no
#  - conda update -q conda
#  # Useful for debugging any issues with conda
#  - conda info -a
#
#  # Replace dep1 dep2 ... with your dependencies
#  - conda create -q -n test-environment python=$TRAVIS_PYTHON_VERSION ipython pytest numpy scipy matplotlib pandas astropy numexpr hdf5 pytables pyyaml dill iminuit sympy
#  - source activate test-environment
#  - pip install emcee uncertainties corner ipyparallel coveralls pytest-cov
#  # Download and install latest version of astromodels
#  - pip install git+https://github.com/giacomov/astromodels.git
#  - pip install .
#  - python -c "from threeML.config.config import Config; print(Config()._configuration['parallel'].keys())"
#
#script:
#  # Set to non-interactive backend for matplotlib
#  - export MPLBACKEND='Agg'
#  # Run tests
#
#  #- py.test --cov-report= --cov=threeML #threeML/test
#  - coverage run --source=threeML setup.py test
#
#
## Calculate coverage
#after_success:
#  - coveralls #--config_file .coveragerc


services:
  - docker

before_install:
- docker pull giacomov/hawc-docker
- docker ps -a
- pip install coveralls

script:
- docker run --rm -it giacomov/hawc-docker /bin/bash --login -c 'source ~/.bashrc && python -c "import hawc" && cd /home/hawc/ && git clone https://github.com/giacomov/3ML.git && cd 3ML && pip install . && pip install git+https://github.com/giacomov/astromodels.git git+https://github.com/giacomov/cthreeML.git pytest pytest-cov && export MPLBACKEND='Agg' && pwd && ls && python setup.py test'

after_success:
  - coveralls #--config_file .coveragerc